package com.example.test;

import com.example.Person;
import com.example.Account;

rule "Test multi-line bracket matching"
when
    $person : Person(
        age > 18,
        name != null
    )
    exists(
        Account(
            owner == $person,
            balance > 1000,
            type in ("CHECKING", "SAVINGS")
        )
    )
    not(
        Restriction(
            customer == $person,
            active == true
        )
    )
    eval(
        $person.getAge() >= 21 &&
        $person.getCreditScore() > 700
    )
then
    System.out.println("All conditions met");
end

rule "Test nested multi-line patterns"
when
    $customer : Customer(
        status == "ACTIVE"
    )
    exists(
        Account(
            owner == $customer
        ) and
        not(
            Debt(
                person == $customer,
                amount > 1000
            )
        )
    )
then
    $customer.setTier("PREMIUM");
end

rule "Test complex nested brackets"
when
    $person : Person()
    exists(
        Account(
            owner == $person,
            type == "PREMIUM"
        ) and
        forall(
            Transaction(
                account.owner == $person,
                amount > 100
            )
            CreditCheck(
                customer == $person,
                approved == true
            )
        )
    )
then
    System.out.println("Complex pattern matched");
end